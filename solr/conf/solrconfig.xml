<?xml version="1.0" encoding="UTF-8" ?>
<config>
  <!-- NOTE: various comments and unused configuration possibilities have been purged
       from this file.  Please refer to http://wiki.apache.org/solr/SolrConfigXml,
       as well as the default solrconfig file included with Solr -->

  <abortOnConfigurationError>${solr.abortOnConfigurationError:true}</abortOnConfigurationError>

  <luceneMatchVersion>7.4.0</luceneMatchVersion>

  <directoryFactory name="DirectoryFactory" class="${solr.directoryFactory:solr.StandardDirectoryFactory}"/>

  <!-- solr lib dirs -->
  <lib dir="${solr.install.dir:../../../..}/contrib/analysis-extras/lib" />
  <lib dir="${solr.install.dir:../../../..}/contrib/analysis-extras/lucene-libs" />

  <dataDir>${solr.blacklight-core.data.dir:}</dataDir>

  <codecFactory class="solr.SchemaCodecFactory"/>

  <schemaFactory class="ClassicIndexSchemaFactory"/>

  <!-- config for the admin interface --> 
  <admin>
    <defaultQuery>*:*</defaultQuery>
  </admin>

  <requestHandler name="search" class="solr.SearchHandler" default="true">
    <!-- default values for query parameters can be specified, these
         will be overridden by parameters in the request
      -->
     <lst name="defaults">
       <str name="defType">edismax</str>
       <str name="echoParams">explicit</str>
       <int name="rows">10</int>
       <str name="q.alt">*:*</str>
       <str name="mm">2&lt;-1 5&lt;-2 6&lt;90%</str>
       <int name="qs">1</int>
       <int name="ps">2</int>
       <float name="tie">0.01</float>

       <!-- this qf and pf are used by default, if not otherwise specified by
            client. The default blacklight will use these for the
            "keywords" search. See the author_qf/author_pf, title_qf, etc 
            below, which the default blacklight will specify for
            those searches. You may also be interested in:
            http://wiki.apache.org/solr/LocalParams
       -->
       <str name="qf">
         id
         title_unstem_search^100000
         subtitle_unstem_search^50000
         title_t^25000
         subtitle_t^10000
         title_addl_unstem_search^5000
         title_addl_t^2500
         title_added_entry_unstem_search^1500
         title_added_entry_t^1250
         subject_topic_unstem_search^1000
         subject_unstem_search^750
         subject_topic_facet^625
         subject_t^500
         author_unstem_search^250
         author_addl_unstem_search^250
         author_t^100
         author_addl_t^50
         subject_addl_unstem_search^250
         subject_addl_t^50
         title_series_unstem_search^25
         title_series_t^10
         isbn_ssim
         all_text_timv
       </str>
       <str name="pf">
         title_unstem_search^1000000
         subtitle_unstem_search^500000
         title_t^250000
         subtitle_t^100000
         title_addl_unstem_search^50000
         title_addl_t^25000
         title_added_entry_unstem_search^15000
         title_added_entry_t^12500
         subject_topic_unstem_search^10000
         subject_unstem_search^7500
         subject_topic_facet^6250
         subject_t^5000
         author_unstem_search^2500
         author_addl_unstem_search^2500
         author_t^1000
         author_addl_t^500
         subject_addl_unstem_search^2500
         subject_addl_t^500
         title_series_unstem_search^250
         title_series_t^100
         all_text_timv^10
       </str>
       <str name="author_qf">
         author_unstem_search^200
         author_addl_unstem_search^50
         author_t^20
         author_addl_t
       </str>
       <str name="author_pf">
         author_unstem_search^2000
         author_addl_unstem_search^500
         author_t^200
         author_addl_t^10
       </str>
       <str name="title_qf">
         title_unstem_search^50000
         subtitle_unstem_search^25000
         title_addl_unstem_search^10000
         title_t^5000
         subtitle_t^2500
         title_addl_t^100
         title_added_entry_unstem_search^50
         title_added_entry_t^10
         title_series_unstem_search^5
         title_series_t
       </str>
       <str name="title_pf">
         title_unstem_search^500000
         subtitle_unstem_search^250000
         title_addl_unstem_search^100000
         title_t^50000
         subtitle_t^25000
         title_addl_t^1000
         title_added_entry_unstem_search^500
         title_added_entry_t^100
         title_series_t^50
         title_series_unstem_search^10
       </str>
       <str name="subject_qf">
         subject_topic_unstem_search^200
         subject_unstem_search^125
         subject_topic_facet^100
         subject_t^50
         subject_addl_unstem_search^10
         subject_addl_t
       </str>
       <str name="subject_pf">
         subject_topic_unstem_search^2000
         subject_unstem_search^1250
         subject_t^1000
         subject_topic_facet^500
         subject_addl_unstem_search^100
         subject_addl_t^10
       </str>

       <str name="fl">
         id, 
         score,
         author_person_display_ssm,
         author_person_vern_display_ssm,
         author_corp_display_ssm,
         author_corp_vern_display_ssm,
         author_meeting_display_ssm,
         author_meeting_vern_display_ssm,
         addl_author_display_ssm,
         addl_author_vern_display_ssm,
         format, 
         isbn_ssim,
         language_facet_ssim,
         lc_callnum_display_ssm,
         material_type_display_ssm,
         published_display_ssm,
         published_vern_display_ssm,
         pub_date,
         title_display_ssm,
         title_vern_display_ssm,
         subject_topic_facet,
         subtitle_display_ssm,
         subtitle_vern_display_ssm,
         url_fulltext_display_ssm,
         url_suppl_display_ssm,
         marc_display_ss
       </str>

       <str name="facet">true</str>
       <str name="facet.mincount">1</str>
       <str name="facet.limit">20</str>
       <str name="facet.field">format</str>
       <str name="facet.field">lc_1letter_facet_sim</str>
       <str name="facet.field">lc_alpha_facet_sim</str>
       <str name="facet.field">lc_b4cutter_facet_sim</str>
       <str name="facet.field">language_facet_ssim</str>
       <str name="facet.field">pub_date_ssim</str>
       <str name="facet.field">authors_all_facet_sim</str>
       <str name="facet.field">subject_topic_facet</str>

       <str name="spellcheck">true</str>
       <str name="spellcheck.dictionary">default</str>
       <str name="spellcheck.onlyMorePopular">true</str>
       <str name="spellcheck.extendedResults">true</str>
       <str name="spellcheck.collate">false</str>
       <str name="spellcheck.count">5</str>

     </lst>
    <arr name="last-components">
      <str>spellcheck</str>
    </arr>
  </requestHandler>

  <!-- for requests to get a single document; use id=666 instead of q=id:666 -->
  <requestHandler name="document" class="solr.SearchHandler" >
    <lst name="defaults">
      <str name="echoParams">all</str>
      <str name="fl">*</str>
      <str name="rows">1</str>
      <str name="q">{!term f=id v=$id}</str> <!-- use id=666 instead of q=id:666 -->
    </lst>
  </requestHandler>

  <requestHandler name="standard" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="echoParams">explicit</str>
      <str name="defType">lucene</str>
    </lst>
  </requestHandler>


  <searchComponent name="spellcheck" class="solr.SpellCheckComponent">
    <str name="queryAnalyzerFieldType">textSpell</str>
    <!-- Multiple "Spell Checkers" can be declared and used by this component
      (e.g. for title_spell field)
      -->
    <lst name="spellchecker">
      <str name="name">default</str>
      <str name="field">spell</str>
      <str name="spellcheckIndexDir">./spell</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">author</str>
      <str name="field">author_spell</str>
      <str name="spellcheckIndexDir">./spell_author</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">subject</str>
      <str name="field">subject_spell</str>
      <str name="spellcheckIndexDir">./spell_subject</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>
    <lst name="spellchecker">
      <str name="name">title</str>
      <str name="field">title_spell</str>
      <str name="spellcheckIndexDir">./spell_title</str>
      <str name="accuracy">0.7</str>
      <str name="buildOnOptimize">true</str>
    </lst>

  </searchComponent>

  <requestHandler name="/replication" class="solr.ReplicationHandler" startup="lazy" />

  <requestDispatcher handleSelect="true" >
    <requestParsers enableRemoteStreaming="true" multipartUploadLimitInKB="2048" />
  </requestDispatcher>

  <requestHandler name="/analysis/field" startup="lazy" class="solr.FieldAnalysisRequestHandler" />

</config>

